ğ™ğ™ğ™š ğ™‘ğ™šğ™˜ğ™©ğ™¤ğ™§ ğ™ğ™šğ™–ğ™§ğ™˜ğ™ ğ˜¼ğ™¢ğ™£ğ™šğ™¨ğ™ğ™– ğ™ğ™§ğ™–ğ™¥ ğŸ§ 

You're in a System Design interview at Perplexity AI. The interviewer asks:

"ğ˜ğ˜¦ ğ˜¢ğ˜³ğ˜¦ ğ˜£ğ˜¶ğ˜ªğ˜­ğ˜¥ğ˜ªğ˜¯ğ˜¨ ğ˜¢ ğ˜™ğ˜ˆğ˜ ğ˜´ğ˜ºğ˜´ğ˜µğ˜¦ğ˜® ğ˜§ğ˜°ğ˜³ ğ˜¢ ğ˜­ğ˜¦ğ˜¨ğ˜¢ğ˜­ ğ˜¥ğ˜¢ğ˜µğ˜¢ğ˜£ğ˜¢ğ˜´ğ˜¦. ğ˜œğ˜´ğ˜¦ğ˜³ğ˜´ ğ˜¯ğ˜¦ğ˜¦ğ˜¥ ğ˜µğ˜° ğ˜§ğ˜ªğ˜¯ğ˜¥ ğ˜´ğ˜±ğ˜¦ğ˜¤ğ˜ªğ˜§ğ˜ªğ˜¤ ğ˜¤ğ˜¢ğ˜´ğ˜¦ ğ˜ğ˜‹ğ˜´ ğ˜¢ğ˜¯ğ˜¥ ğ˜¤ğ˜­ğ˜¢ğ˜¶ğ˜´ğ˜¦ğ˜´ ğ˜µğ˜©ğ˜¢ğ˜µ ğ˜¥ğ˜° ğ˜¯ğ˜°ğ˜µ ğ˜¤ğ˜°ğ˜¯ğ˜µğ˜¢ğ˜ªğ˜¯ ğ˜­ğ˜ªğ˜¢ğ˜£ğ˜ªğ˜­ğ˜ªğ˜µğ˜º ğ˜¸ğ˜¢ğ˜ªğ˜·ğ˜¦ğ˜³ğ˜´. ğ˜ğ˜°ğ˜¸ ğ˜¥ğ˜° ğ˜ºğ˜°ğ˜¶ ğ˜¥ğ˜¦ğ˜´ğ˜ªğ˜¨ğ˜¯ ğ˜µğ˜©ğ˜¦ ğ˜³ğ˜¦ğ˜µğ˜³ğ˜ªğ˜¦ğ˜·ğ˜¢ğ˜­ ğ˜­ğ˜¢ğ˜ºğ˜¦ğ˜³?"

ğŸ—£ï¸ 90% of candidates walk right into the trap.

They say: "ğ˜Œğ˜¢ğ˜´ğ˜º. ğ˜ğ˜¦ ğ˜¶ğ˜´ğ˜¦ ğ˜¢ ğ˜ğ˜¦ğ˜¤ğ˜µğ˜°ğ˜³ ğ˜‹ğ˜¢ğ˜µğ˜¢ğ˜£ğ˜¢ğ˜´ğ˜¦ (ğ˜­ğ˜ªğ˜¬ğ˜¦ ğ˜—ğ˜ªğ˜¯ğ˜¦ğ˜¤ğ˜°ğ˜¯ğ˜¦ ğ˜°ğ˜³ ğ˜”ğ˜ªğ˜­ğ˜·ğ˜¶ğ˜´). ğ˜ğ˜¦ ğ˜¦ğ˜®ğ˜£ğ˜¦ğ˜¥ ğ˜µğ˜©ğ˜¦ ğ˜¥ğ˜°ğ˜¤ğ˜¶ğ˜®ğ˜¦ğ˜¯ğ˜µğ˜´ ğ˜¢ğ˜¯ğ˜¥ ğ˜µğ˜©ğ˜¦ ğ˜²ğ˜¶ğ˜¦ğ˜³ğ˜º ğ˜¶ğ˜´ğ˜ªğ˜¯ğ˜¨ ğ˜–ğ˜±ğ˜¦ğ˜¯ğ˜ˆğ˜'ğ˜´ ğ˜¦ğ˜®ğ˜£ğ˜¦ğ˜¥ğ˜¥ğ˜ªğ˜¯ğ˜¨ğ˜´, ğ˜µğ˜©ğ˜¦ğ˜¯ ğ˜¶ğ˜´ğ˜¦ ğ˜Šğ˜°ğ˜´ğ˜ªğ˜¯ğ˜¦ ğ˜šğ˜ªğ˜®ğ˜ªğ˜­ğ˜¢ğ˜³ğ˜ªğ˜µğ˜º ğ˜µğ˜° ğ˜§ğ˜ªğ˜¯ğ˜¥ ğ˜µğ˜©ğ˜¦ ğ˜µğ˜°ğ˜±-ğ˜¬ ğ˜®ğ˜¢ğ˜µğ˜¤ğ˜©ğ˜¦ğ˜´."

It sounds modern. It fails completely in production.

ğ—§ğ—µğ—² ğ—¥ğ—²ğ—®ğ—¹ğ—¶ğ˜ğ˜†: ğ——ğ—²ğ—»ğ˜€ğ—² ğ—˜ğ—ºğ—¯ğ—²ğ—±ğ—±ğ—¶ğ—»ğ—´ğ˜€ ğ—®ğ—¿ğ—² "ğ—™ğ˜‚ğ˜‡ğ˜‡ğ˜†" ğ— ğ—®ğ˜ğ—°ğ—µğ—²ğ—¿ğ˜€.

Vector embeddings encode ğ˜´ğ˜¦ğ˜®ğ˜¢ğ˜¯ğ˜µğ˜ªğ˜¤ ğ˜®ğ˜¦ğ˜¢ğ˜¯ğ˜ªğ˜¯ğ˜¨, not exact characters.

â€¢ They fail at ğ—˜ğ˜…ğ—®ğ—°ğ˜ ğ— ğ—®ğ˜ğ—°ğ—µ: A vector search for ID "US-4059" might return "US-4058" because they are semantically identical (both are IDs), even though the user needs the exact string.
 
â€¢ They fail at ğ—¡ğ—²ğ—´ğ—®ğ˜ğ—¶ğ—¼ğ—»: Most embedding models ignore the word "not." A query for "clauses that do ğ˜¯ğ˜°ğ˜µ contain waivers" will return clauses ğ˜§ğ˜¶ğ˜­ğ˜­ of waivers, because the vector aligns with the concept of "waiver."
 

âœ… ğ—§ğ—µğ—² ğ—¦ğ—¼ğ—¹ğ˜‚ğ˜ğ—¶ğ—¼ğ—»: ğ—¬ğ—¼ğ˜‚ ğ—»ğ—²ğ—²ğ—± ğ—›ğ˜†ğ—¯ğ—¿ğ—¶ğ—± ğ—¦ğ—²ğ—®ğ—¿ğ—°ğ—µ ğ˜„ğ—¶ğ˜ğ—µ ğ—¥ğ—¥ğ—™.

You cannot rely on dense retrieval alone. You must implement a ğ—›ğ˜†ğ—¯ğ—¿ğ—¶ğ—± ğ—¥ğ—²ğ˜ğ—¿ğ—¶ğ—²ğ˜ƒğ—®ğ—¹ pipeline.

1. ğ——ğ—²ğ—»ğ˜€ğ—² ğ—¥ğ—²ğ˜ğ—¿ğ—¶ğ—²ğ˜ƒğ—®ğ—¹: Use vectors to capture the semantic intent ("lawsuits about slips").
 
2. ğ—¦ğ—½ğ—®ğ—¿ğ˜€ğ—² ğ—¥ğ—²ğ˜ğ—¿ğ—¶ğ—²ğ˜ƒğ—®ğ—¹ (ğ—•ğ— ğŸ®ğŸ±): Use an inverted index (keyword search) to enforce exact matches on IDs and handle specific terminology.
 
3. ğ—¥ğ—²ğ—°ğ—¶ğ—½ğ—¿ğ—¼ğ—°ğ—®ğ—¹ ğ—¥ğ—®ğ—»ğ—¸ ğ—™ğ˜‚ğ˜€ğ—¶ğ—¼ğ—» (ğ—¥ğ—¥ğ—™): An algorithm that merges the two lists, normalizing their scores to give you the best of both worlds: semantic understanding and keyword precision.
 

âœï¸ ğ—§ğ—µğ—² ğ—”ğ—»ğ˜€ğ˜„ğ—²ğ—¿ ğ—§ğ—µğ—®ğ˜ ğ—šğ—²ğ˜ğ˜€ ğ—¬ğ—¼ğ˜‚ ğ—›ğ—¶ğ—¿ğ—²ğ—±:

"ğ˜‹ğ˜¦ğ˜¯ğ˜´ğ˜¦ ğ˜³ğ˜¦ğ˜µğ˜³ğ˜ªğ˜¦ğ˜·ğ˜¢ğ˜­ ğ˜§ğ˜¢ğ˜ªğ˜­ğ˜´ ğ˜°ğ˜¯ ğ˜¦ğ˜¹ğ˜¢ğ˜¤ğ˜µ ğ˜¬ğ˜¦ğ˜ºğ˜¸ğ˜°ğ˜³ğ˜¥ğ˜´ ğ˜¢ğ˜¯ğ˜¥ ğ˜¯ğ˜¦ğ˜¨ğ˜¢ğ˜µğ˜ªğ˜°ğ˜¯ğ˜´ ğ˜¤ğ˜³ğ˜ªğ˜µğ˜ªğ˜¤ğ˜¢ğ˜­ ğ˜§ğ˜°ğ˜³ ğ˜­ğ˜¦ğ˜¨ğ˜¢ğ˜­ ğ˜´ğ˜¦ğ˜¢ğ˜³ğ˜¤ğ˜©. ğ˜ ğ˜¸ğ˜°ğ˜¶ğ˜­ğ˜¥ ğ˜ªğ˜®ğ˜±ğ˜­ğ˜¦ğ˜®ğ˜¦ğ˜¯ğ˜µ ğ˜ğ˜ºğ˜£ğ˜³ğ˜ªğ˜¥ ğ˜šğ˜¦ğ˜¢ğ˜³ğ˜¤ğ˜©. ğ˜ğ˜¦ ğ˜³ğ˜¶ğ˜¯ ğ˜¢ ğ˜‰ğ˜”25 (ğ˜šğ˜±ğ˜¢ğ˜³ğ˜´ğ˜¦) ğ˜²ğ˜¶ğ˜¦ğ˜³ğ˜º ğ˜ªğ˜¯ ğ˜±ğ˜¢ğ˜³ğ˜¢ğ˜­ğ˜­ğ˜¦ğ˜­ ğ˜¸ğ˜ªğ˜µğ˜© ğ˜µğ˜©ğ˜¦ ğ˜ğ˜¦ğ˜¤ğ˜µğ˜°ğ˜³ (ğ˜‹ğ˜¦ğ˜¯ğ˜´ğ˜¦) ğ˜²ğ˜¶ğ˜¦ğ˜³ğ˜º ğ˜µğ˜° ğ˜¤ğ˜¢ğ˜±ğ˜µğ˜¶ğ˜³ğ˜¦ ğ˜£ğ˜°ğ˜µğ˜© ğ˜´ğ˜±ğ˜¦ğ˜¤ğ˜ªğ˜§ğ˜ªğ˜¤ ğ˜ğ˜‹ğ˜´ ğ˜¢ğ˜¯ğ˜¥ ğ˜£ğ˜³ğ˜°ğ˜¢ğ˜¥ ğ˜¤ğ˜°ğ˜¯ğ˜¤ğ˜¦ğ˜±ğ˜µğ˜´. ğ˜ğ˜¦ ğ˜µğ˜©ğ˜¦ğ˜¯ ğ˜¶ğ˜´ğ˜¦ ğ˜™ğ˜¦ğ˜¤ğ˜ªğ˜±ğ˜³ğ˜°ğ˜¤ğ˜¢ğ˜­ ğ˜™ğ˜¢ğ˜¯ğ˜¬ ğ˜ğ˜¶ğ˜´ğ˜ªğ˜°ğ˜¯ (ğ˜™ğ˜™ğ˜) ğ˜µğ˜° ğ˜³ğ˜¦-ğ˜³ğ˜¢ğ˜¯ğ˜¬ ğ˜µğ˜©ğ˜¦ ğ˜³ğ˜¦ğ˜´ğ˜¶ğ˜­ğ˜µğ˜´ ğ˜£ğ˜¦ğ˜§ğ˜°ğ˜³ğ˜¦ ğ˜§ğ˜¦ğ˜¦ğ˜¥ğ˜ªğ˜¯ğ˜¨ ğ˜µğ˜©ğ˜¦ğ˜® ğ˜µğ˜° ğ˜µğ˜©ğ˜¦ ğ˜“ğ˜“ğ˜”."
